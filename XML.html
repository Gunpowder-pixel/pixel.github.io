<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1894.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    span.Apple-tab-span {white-space:pre}
  </style>
</head>
<body>
<p class="p1"><br></p>
<p class="p2">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;<span class="Apple-converted-space"> </span></p>
<p class="p2">&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;<span class="Apple-converted-space"> </span></p>
<p class="p2">&lt;head&gt;</p>
<p class="p2"><span class="Apple-converted-space"> </span>&lt;title&gt;JS1k: Breathing Galaxies (1013 bytes)&lt;/title&gt;</p>
<p class="p2"><span class="Apple-converted-space"> </span>&lt;script type="text/javascript"&gt;</p>
<p class="p2">window.onload = function () {</p>
<p class="p2"><span class="Apple-tab-span">	</span>C = Math.cos; // cache Math objects</p>
<p class="p2"><span class="Apple-tab-span">	</span>S = Math.sin;</p>
<p class="p2"><span class="Apple-tab-span">	</span>U = 0;</p>
<p class="p2"><span class="Apple-tab-span">	</span>w = window;</p>
<p class="p2"><span class="Apple-tab-span">	</span>j = document;</p>
<p class="p2"><span class="Apple-tab-span">	</span>d = j.getElementById("c");</p>
<p class="p2"><span class="Apple-tab-span">	</span>c = d.getContext("2d");</p>
<p class="p2"><span class="Apple-tab-span">	</span>W = d.width = w.innerWidth;</p>
<p class="p2"><span class="Apple-tab-span">	</span>H = d.height = w.innerHeight;</p>
<p class="p2"><span class="Apple-tab-span">	</span>c.fillRect(0, 0, W, H); // resize &lt;canvas&gt; and draw black rect (default)</p>
<p class="p2"><span class="Apple-tab-span">	</span>c.globalCompositeOperation = "lighter"; // switch to additive color application</p>
<p class="p2"><span class="Apple-tab-span">	</span>c.lineWidth = 0.2;</p>
<p class="p2"><span class="Apple-tab-span">	</span>c.lineCap = "round";</p>
<p class="p2"><span class="Apple-tab-span">	</span>var bool = 0,<span class="Apple-converted-space"> </span></p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>t = 0; // theta</p>
<p class="p2"><span class="Apple-tab-span">	</span>d.onmousemove = function (e) {</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(window.T) {</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(D==9) { D=Math.random()*15; f(1); }</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>clearTimeout(T);</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>X = e.pageX; // grab mouse pixel coords</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Y = e.pageY;</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a=0; // previous coord.x</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>b=0; // previous coord.y<span class="Apple-converted-space"> </span></p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>A = X, // original coord.x</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>B = Y; // original coord.y</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>R=(e.pageX/W * 999&gt;&gt;0)/999;</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>r=(e.pageY/H * 999&gt;&gt;0)/999;</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>U=e.pageX/H * 360 &gt;&gt;0;</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>D=9;</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>g = 360 * Math.PI / 180;</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>T = setInterval(f = function (e) { // start looping spectrum</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.save();</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.globalCompositeOperation = "source-over"; // switch to additive color application</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(e!=1) {</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.fillStyle = "rgba(0,0,0,0.02)";</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.fillRect(0, 0, W, H); // resize &lt;canvas&gt; and draw black rect (default)</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.restore();</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>i = 25; while(i --) {</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.beginPath();</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(D &gt; 450 || bool) { // decrease diameter</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(!bool) { // has hit maximum</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bool = 1;</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(D &lt; 0.1) { // has hit minimum</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bool = 0;</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>t -= g; // decrease theta</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>D -= 0.1; // decrease size</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(!bool) {</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>t += g; // increase theta</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>D += 0.1; // increase size</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>q = (R / r - 1) * t; // create hypotrochoid from current mouse position, and setup variables (see: http://en.wikipedia.org/wiki/Hypotrochoid)</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>x = (R - r) * C(t) + D * C(q) + (A + (X - A) * (i / 25)) + (r - R); // center on xy coords</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>y = (R - r) * S(t) - D * S(q) + (B + (Y - B) * (i / 25));</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (a) { // draw once two points are set</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.moveTo(a, b);</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.lineTo(x, y)</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.strokeStyle = "hsla(" + (U % 360) + ",100%,50%,0.75)"; // draw rainbow hypotrochoid</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>c.stroke();</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a = x; // set previous coord.x</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>b = y; // set previous coord.y</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>U -= 0.5; // increment hue</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>A = X; // set original coord.x</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>B = Y; // set original coord.y</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}, 16);</p>
<p class="p2"><span class="Apple-tab-span">	</span>}</p>
<p class="p2"><span class="Apple-tab-span">	</span>j.onkeydown = function(e) { a=b=0; R += 0.05 }</p>
<p class="p2"><span class="Apple-tab-span">	</span>d.onmousemove({pageX:300, pageY:290})</p>
<p class="p2">}</p>
<p class="p1"><br></p>
<p class="p2">&lt;/script&gt;</p>
<p class="p2">&lt;/head&gt;</p>
<p class="p2">&lt;body&gt;</p>
<p class="p2">&lt;canvas id="c"&gt;&lt;/canvas&gt;</p>
<p class="p2">&lt;/body&gt;</p>
<p class="p2">&lt;/html&gt;</p>
</body>
</html>
